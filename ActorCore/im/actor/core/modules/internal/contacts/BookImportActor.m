//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/internal/contacts/BookImportActor.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "im/actor/core/Configuration.h"
#include "im/actor/core/PhoneBookProvider.h"
#include "im/actor/core/api/ApiEmailToImport.h"
#include "im/actor/core/api/ApiPhoneToImport.h"
#include "im/actor/core/api/ApiUser.h"
#include "im/actor/core/api/base/FatSeqUpdate.h"
#include "im/actor/core/api/rpc/RequestImportContacts.h"
#include "im/actor/core/api/rpc/ResponseImportContacts.h"
#include "im/actor/core/api/updates/UpdateContactsAdded.h"
#include "im/actor/core/entity/PhoneBookContact.h"
#include "im/actor/core/entity/PhoneBookEmail.h"
#include "im/actor/core/entity/PhoneBookPhone.h"
#include "im/actor/core/modules/ModuleContext.h"
#include "im/actor/core/modules/Updates.h"
#include "im/actor/core/modules/internal/AppStateModule.h"
#include "im/actor/core/modules/internal/contacts/BookImportActor.h"
#include "im/actor/core/modules/utils/ModuleActor.h"
#include "im/actor/core/network/RpcCallback.h"
#include "im/actor/core/network/RpcException.h"
#include "im/actor/runtime/Log.h"
#include "im/actor/runtime/actors/Actor.h"
#include "im/actor/runtime/actors/ActorRef.h"
#include "im/actor/runtime/storage/PreferencesStorage.h"
#include "java/lang/Integer.h"
#include "java/lang/Long.h"
#include "java/util/ArrayList.h"
#include "java/util/HashSet.h"
#include "java/util/List.h"

#pragma clang diagnostic push
#pragma GCC diagnostic ignored "-Wdeprecated-declarations"

#define ACBookImportActor_MAX_IMPORT_SIZE 50

@interface ACBookImportActor () {
 @public
  jboolean ENABLE_LOG_;
  JavaUtilHashSet *importingPhones_;
  JavaUtilHashSet *importingEmails_;
  jboolean isSyncInProgress_;
}

- (void)performSync;

- (void)onPhoneBookLoadedWithJavaUtilList:(id<JavaUtilList>)phoneBook;

- (void)performImportWithJavaUtilArrayList:(JavaUtilArrayList *)phoneToImportsPart
                     withJavaUtilArrayList:(JavaUtilArrayList *)emailToImportsPart;

- (jboolean)isImportedWithLong:(jlong)phone;

- (jboolean)isImportedWithNSString:(NSString *)email;

- (void)markImportedWithLong:(jlong)phone;

- (void)markImportedWithNSString:(NSString *)email;

- (void)markImported;

@end

J2OBJC_FIELD_SETTER(ACBookImportActor, importingPhones_, JavaUtilHashSet *)
J2OBJC_FIELD_SETTER(ACBookImportActor, importingEmails_, JavaUtilHashSet *)

static NSString *ACBookImportActor_TAG_ = @"ContactsImport";
J2OBJC_STATIC_FIELD_GETTER(ACBookImportActor, TAG_, NSString *)

J2OBJC_STATIC_FIELD_GETTER(ACBookImportActor, MAX_IMPORT_SIZE, jint)

__attribute__((unused)) static void ACBookImportActor_performSync(ACBookImportActor *self);

__attribute__((unused)) static void ACBookImportActor_onPhoneBookLoadedWithJavaUtilList_(ACBookImportActor *self, id<JavaUtilList> phoneBook);

__attribute__((unused)) static void ACBookImportActor_performImportWithJavaUtilArrayList_withJavaUtilArrayList_(ACBookImportActor *self, JavaUtilArrayList *phoneToImportsPart, JavaUtilArrayList *emailToImportsPart);

__attribute__((unused)) static jboolean ACBookImportActor_isImportedWithLong_(ACBookImportActor *self, jlong phone);

__attribute__((unused)) static jboolean ACBookImportActor_isImportedWithNSString_(ACBookImportActor *self, NSString *email);

__attribute__((unused)) static void ACBookImportActor_markImportedWithLong_(ACBookImportActor *self, jlong phone);

__attribute__((unused)) static void ACBookImportActor_markImportedWithNSString_(ACBookImportActor *self, NSString *email);

__attribute__((unused)) static void ACBookImportActor_markImported(ACBookImportActor *self);

@interface ACBookImportActor_PhoneBookLoaded : NSObject {
 @public
  id<JavaUtilList> phoneBook_;
}

- (instancetype)initWithJavaUtilList:(id<JavaUtilList>)phoneBook;

- (id<JavaUtilList>)getPhoneBook;

@end

J2OBJC_EMPTY_STATIC_INIT(ACBookImportActor_PhoneBookLoaded)

J2OBJC_FIELD_SETTER(ACBookImportActor_PhoneBookLoaded, phoneBook_, id<JavaUtilList>)

__attribute__((unused)) static void ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(ACBookImportActor_PhoneBookLoaded *self, id<JavaUtilList> phoneBook);

__attribute__((unused)) static ACBookImportActor_PhoneBookLoaded *new_ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(id<JavaUtilList> phoneBook) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ACBookImportActor_PhoneBookLoaded)

@interface ACBookImportActor_$1 : NSObject < ACPhoneBookProvider_Callback > {
 @public
  ACBookImportActor *this$0_;
}

- (void)onLoadedWithContacts:(id<JavaUtilList>)contacts;

- (instancetype)initWithACBookImportActor:(ACBookImportActor *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(ACBookImportActor_$1)

J2OBJC_FIELD_SETTER(ACBookImportActor_$1, this$0_, ACBookImportActor *)

__attribute__((unused)) static void ACBookImportActor_$1_initWithACBookImportActor_(ACBookImportActor_$1 *self, ACBookImportActor *outer$);

__attribute__((unused)) static ACBookImportActor_$1 *new_ACBookImportActor_$1_initWithACBookImportActor_(ACBookImportActor *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ACBookImportActor_$1)

@interface ACBookImportActor_$2 : NSObject < ACRpcCallback > {
 @public
  ACBookImportActor *this$0_;
  IOSObjectArray *val$phones_;
  IOSObjectArray *val$emailToImports_;
}

- (void)onResult:(ARResponseImportContacts *)response;

- (void)onError:(ACRpcException *)e;

- (instancetype)initWithACBookImportActor:(ACBookImportActor *)outer$
              withARApiPhoneToImportArray:(IOSObjectArray *)capture$0
              withARApiEmailToImportArray:(IOSObjectArray *)capture$1;

@end

J2OBJC_EMPTY_STATIC_INIT(ACBookImportActor_$2)

J2OBJC_FIELD_SETTER(ACBookImportActor_$2, this$0_, ACBookImportActor *)
J2OBJC_FIELD_SETTER(ACBookImportActor_$2, val$phones_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(ACBookImportActor_$2, val$emailToImports_, IOSObjectArray *)

__attribute__((unused)) static void ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(ACBookImportActor_$2 *self, ACBookImportActor *outer$, IOSObjectArray *capture$0, IOSObjectArray *capture$1);

__attribute__((unused)) static ACBookImportActor_$2 *new_ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(ACBookImportActor *outer$, IOSObjectArray *capture$0, IOSObjectArray *capture$1) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ACBookImportActor_$2)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/internal/contacts/BookImportActor.java"


#line 29
@implementation ACBookImportActor


#line 42
- (instancetype)initWithACModuleContext:(id<ACModuleContext>)context {
  ACBookImportActor_initWithACModuleContext_(self, context);
  return self;
}


#line 48
- (void)preStart {
  [super preStart];
  [((ARActorRef *) nil_chk([self self__])) sendWithId:new_ACBookImportActor_PerformSync_init()];
}

- (void)performSync {
  ACBookImportActor_performSync(self);
}


#line 77
- (void)onPhoneBookLoadedWithJavaUtilList:(id<JavaUtilList>)phoneBook {
  ACBookImportActor_onPhoneBookLoadedWithJavaUtilList_(self, phoneBook);
}


#line 151
- (void)performImportWithJavaUtilArrayList:(JavaUtilArrayList *)phoneToImportsPart
                     withJavaUtilArrayList:(JavaUtilArrayList *)emailToImportsPart {
  ACBookImportActor_performImportWithJavaUtilArrayList_withJavaUtilArrayList_(self, phoneToImportsPart, emailToImportsPart);
}


#line 213
- (jboolean)isImportedWithLong:(jlong)phone {
  return ACBookImportActor_isImportedWithLong_(self, phone);
}

- (jboolean)isImportedWithNSString:(NSString *)email {
  return ACBookImportActor_isImportedWithNSString_(self, email);
}

- (void)markImportedWithLong:(jlong)phone {
  ACBookImportActor_markImportedWithLong_(self, phone);
}

- (void)markImportedWithNSString:(NSString *)email {
  ACBookImportActor_markImportedWithNSString_(self, email);
}

- (void)markImported {
  ACBookImportActor_markImported(self);
}


#line 234
- (void)onReceiveWithId:(id)message {
  if ([message isKindOfClass:[ACBookImportActor_PerformSync class]]) {
    ACBookImportActor_performSync(self);
  }
  else
#line 237
  if ([message isKindOfClass:[ACBookImportActor_PhoneBookLoaded class]]) {
    ACBookImportActor_onPhoneBookLoadedWithJavaUtilList_(self, [((ACBookImportActor_PhoneBookLoaded *) nil_chk(((ACBookImportActor_PhoneBookLoaded *) check_class_cast(message, [ACBookImportActor_PhoneBookLoaded class])))) getPhoneBook]);
  }
  else {
    
#line 240
    [self dropWithId:message];
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithACModuleContext:", "BookImportActor", NULL, 0x1, NULL, NULL },
    { "preStart", NULL, "V", 0x1, NULL, NULL },
    { "performSync", NULL, "V", 0x2, NULL, NULL },
    { "onPhoneBookLoadedWithJavaUtilList:", "onPhoneBookLoaded", "V", 0x2, NULL, NULL },
    { "performImportWithJavaUtilArrayList:withJavaUtilArrayList:", "performImport", "V", 0x2, NULL, NULL },
    { "isImportedWithLong:", "isImported", "Z", 0x2, NULL, NULL },
    { "isImportedWithNSString:", "isImported", "Z", 0x2, NULL, NULL },
    { "markImportedWithLong:", "markImported", "V", 0x2, NULL, NULL },
    { "markImportedWithNSString:", "markImported", "V", 0x2, NULL, NULL },
    { "markImported", NULL, "V", 0x2, NULL, NULL },
    { "onReceiveWithId:", "onReceive", "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "TAG_", NULL, 0x1a, "Ljava.lang.String;", &ACBookImportActor_TAG_, NULL, .constantValue.asLong = 0 },
    { "ENABLE_LOG_", NULL, 0x12, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "MAX_IMPORT_SIZE", "MAX_IMPORT_SIZE", 0x1a, "I", NULL, NULL, .constantValue.asInt = ACBookImportActor_MAX_IMPORT_SIZE },
    { "importingPhones_", NULL, 0x2, "Ljava.util.HashSet;", NULL, "Ljava/util/HashSet<Ljava/lang/Long;>;", .constantValue.asLong = 0 },
    { "importingEmails_", NULL, 0x2, "Ljava.util.HashSet;", NULL, "Ljava/util/HashSet<Ljava/lang/String;>;", .constantValue.asLong = 0 },
    { "isSyncInProgress_", NULL, 0x2, "Z", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lim.actor.core.modules.internal.contacts.BookImportActor$PerformSync;", "Lim.actor.core.modules.internal.contacts.BookImportActor$PhoneBookLoaded;"};
  static const J2ObjcClassInfo _ACBookImportActor = { 2, "BookImportActor", "im.actor.core.modules.internal.contacts", NULL, 0x1, 11, methods, 6, fields, 0, NULL, 2, inner_classes, NULL, NULL };
  return &_ACBookImportActor;
}

@end


#line 42
void ACBookImportActor_initWithACModuleContext_(ACBookImportActor *self, id<ACModuleContext> context) {
  (void) ACModuleActor_initWithACModuleContext_(self, context);
  self->importingPhones_ = new_JavaUtilHashSet_init();
  self->importingEmails_ = new_JavaUtilHashSet_init();
  self->isSyncInProgress_ =
#line 40
  false;
  
#line 44
  self->ENABLE_LOG_ = [((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk(context)) getConfiguration])) isEnableContactsLogging];
}


#line 42
ACBookImportActor *new_ACBookImportActor_initWithACModuleContext_(id<ACModuleContext> context) {
  ACBookImportActor *self = [ACBookImportActor alloc];
  ACBookImportActor_initWithACModuleContext_(self, context);
  return self;
}


#line 53
void ACBookImportActor_performSync(ACBookImportActor *self) {
  if (self->ENABLE_LOG_) {
    ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"Checking sync...");
  }
  if (self->isSyncInProgress_) {
    if (self->ENABLE_LOG_) {
      ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"Sync already in progress");
    }
    return;
  }
  self->isSyncInProgress_ = true;
  if (self->ENABLE_LOG_) {
    ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"Starting book loading...");
  }
  
#line 68
  [((id<ACPhoneBookProvider>) nil_chk([((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getConfiguration])) getPhoneBookProvider])) loadPhoneBookWithCallback:new_ACBookImportActor_$1_initWithACBookImportActor_(self)];
}


#line 77
void ACBookImportActor_onPhoneBookLoadedWithJavaUtilList_(ACBookImportActor *self, id<JavaUtilList> phoneBook) {
  self->isSyncInProgress_ = false;
  if (self->ENABLE_LOG_) {
    ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"Book load completed");
  }
  
#line 83
  JavaUtilArrayList *phoneToImports = new_JavaUtilArrayList_init();
  JavaUtilArrayList *emailToImports = new_JavaUtilArrayList_init();
  for (ACPhoneBookContact * __strong record in nil_chk(phoneBook)) {
    for (ACPhoneBookPhone * __strong phone in nil_chk([((ACPhoneBookContact *) nil_chk(record)) getPhones])) {
      if (ACBookImportActor_isImportedWithLong_(self, [((ACPhoneBookPhone *) nil_chk(phone)) getNumber])) {
        continue;
      }
      if ([((JavaUtilHashSet *) nil_chk(self->importingPhones_)) containsWithId:JavaLangLong_valueOfWithLong_([phone getNumber])]) {
        continue;
      }
      [self->importingPhones_ addWithId:JavaLangLong_valueOfWithLong_([phone getNumber])];
      [phoneToImports addWithId:new_ARApiPhoneToImport_initWithLong_withNSString_([phone getNumber], [record getName])];
    }
    
#line 97
    for (ACPhoneBookEmail * __strong email in nil_chk([record getEmails])) {
      if (ACBookImportActor_isImportedWithNSString_(self, [((NSString *) nil_chk([((ACPhoneBookEmail *) nil_chk(email)) getEmail])) lowercaseString])) {
        continue;
      }
      if ([((JavaUtilHashSet *) nil_chk(self->importingEmails_)) containsWithId:[((NSString *) nil_chk([email getEmail])) lowercaseString]]) {
        continue;
      }
      [self->importingEmails_ addWithId:[((NSString *) nil_chk([email getEmail])) lowercaseString]];
      [emailToImports addWithId:new_ARApiEmailToImport_initWithNSString_withNSString_([((NSString *) nil_chk([email getEmail])) lowercaseString], [record getName])];
    }
  }
  
#line 109
  if ([phoneToImports size] == 0 && [emailToImports size] == 0) {
    if (self->ENABLE_LOG_) {
      ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"No new contacts found");
    }
    ACBookImportActor_markImported(self);
    return;
  }
  else {
    
#line 116
    if (self->ENABLE_LOG_) {
      ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, JreStrcat("$I$", @"Founded new ", ([phoneToImports size] + [emailToImports size]), @" contact records"));
    }
  }
  
#line 121
  JavaUtilArrayList *phoneToImportsPart = new_JavaUtilArrayList_init();
  JavaUtilArrayList *emailToImportsPart = new_JavaUtilArrayList_init();
  jint count = 0;
  for (ARApiPhoneToImport * __strong phoneToImport in phoneToImports) {
    [phoneToImportsPart addWithId:phoneToImport];
    count++;
    if (count >= ACBookImportActor_MAX_IMPORT_SIZE) {
      ACBookImportActor_performImportWithJavaUtilArrayList_withJavaUtilArrayList_(self, phoneToImportsPart, emailToImportsPart);
      [phoneToImportsPart clear];
      [emailToImportsPart clear];
      count = 0;
    }
  }
  
#line 135
  for (ARApiEmailToImport * __strong emailToImport in emailToImports) {
    [emailToImportsPart addWithId:emailToImport];
    count++;
    if (count >= ACBookImportActor_MAX_IMPORT_SIZE) {
      ACBookImportActor_performImportWithJavaUtilArrayList_withJavaUtilArrayList_(self, phoneToImportsPart, emailToImportsPart);
      [phoneToImportsPart clear];
      [emailToImportsPart clear];
      count = 0;
    }
  }
  
#line 146
  if (count > 0) {
    ACBookImportActor_performImportWithJavaUtilArrayList_withJavaUtilArrayList_(self, phoneToImportsPart, emailToImportsPart);
  }
}


#line 151
void ACBookImportActor_performImportWithJavaUtilArrayList_withJavaUtilArrayList_(ACBookImportActor *self, JavaUtilArrayList *phoneToImportsPart, JavaUtilArrayList *emailToImportsPart) {
  
#line 154
  if (self->ENABLE_LOG_) {
    ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, JreStrcat("$I$I$", @"Performing import part with ", [((JavaUtilArrayList *) nil_chk(phoneToImportsPart)) size], @" phones and ",
#line 156
    [((JavaUtilArrayList *) nil_chk(emailToImportsPart)) size], @" emails"));
  }
  
#line 159
  IOSObjectArray *phones = [phoneToImportsPart toArrayWithNSObjectArray:[IOSObjectArray newArrayWithLength:[((JavaUtilArrayList *) nil_chk(phoneToImportsPart)) size] type:ARApiPhoneToImport_class_()]];
  IOSObjectArray *emailToImports = [emailToImportsPart toArrayWithNSObjectArray:[IOSObjectArray newArrayWithLength:[((JavaUtilArrayList *) nil_chk(emailToImportsPart)) size] type:ARApiEmailToImport_class_()]];
  
#line 162
  [self requestWithACRequest:new_ARRequestImportContacts_initWithJavaUtilList_withJavaUtilList_((id<JavaUtilList>) check_protocol_cast([phoneToImportsPart clone], JavaUtilList_class_()),
#line 163
  (id<JavaUtilList>) check_protocol_cast([emailToImportsPart clone], JavaUtilList_class_())) withACRpcCallback:new_ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(self, phones, emailToImports)];
}


#line 213
jboolean ACBookImportActor_isImportedWithLong_(ACBookImportActor *self, jlong phone) {
  return [((id<ARPreferencesStorage>) nil_chk([self preferences])) getBoolWithKey:JreStrcat("$J", @"book_phone_", phone) withDefault:false];
}

jboolean ACBookImportActor_isImportedWithNSString_(ACBookImportActor *self, NSString *email) {
  return [((id<ARPreferencesStorage>) nil_chk([self preferences])) getBoolWithKey:JreStrcat("$$", @"book_email_", [((NSString *) nil_chk(email)) lowercaseString]) withDefault:false];
}

void ACBookImportActor_markImportedWithLong_(ACBookImportActor *self, jlong phone) {
  [((id<ARPreferencesStorage>) nil_chk([self preferences])) putBoolWithKey:JreStrcat("$J", @"book_phone_", phone) withValue:true];
}

void ACBookImportActor_markImportedWithNSString_(ACBookImportActor *self, NSString *email) {
  [((id<ARPreferencesStorage>) nil_chk([self preferences])) putBoolWithKey:JreStrcat("$$", @"book_email_", [((NSString *) nil_chk(email)) lowercaseString]) withValue:true];
}

void ACBookImportActor_markImported(ACBookImportActor *self) {
  [((ACAppStateModule *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getAppStateModule])) onBookImported];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACBookImportActor)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/internal/contacts/BookImportActor.java"


#line 244
@implementation ACBookImportActor_PerformSync

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  ACBookImportActor_PerformSync_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", NULL, NULL, 0x1, NULL, NULL },
  };
  static const J2ObjcClassInfo _ACBookImportActor_PerformSync = { 2, "PerformSync", "im.actor.core.modules.internal.contacts", "BookImportActor", 0x9, 1, methods, 0, NULL, 0, NULL, 0, NULL, NULL, NULL };
  return &_ACBookImportActor_PerformSync;
}

@end

void ACBookImportActor_PerformSync_init(ACBookImportActor_PerformSync *self) {
  (void) NSObject_init(self);
}

ACBookImportActor_PerformSync *new_ACBookImportActor_PerformSync_init() {
  ACBookImportActor_PerformSync *self = [ACBookImportActor_PerformSync alloc];
  ACBookImportActor_PerformSync_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACBookImportActor_PerformSync)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/internal/contacts/BookImportActor.java"


#line 248
@implementation ACBookImportActor_PhoneBookLoaded


#line 251
- (instancetype)initWithJavaUtilList:(id<JavaUtilList>)phoneBook {
  ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(self, phoneBook);
  return self;
}


#line 255
- (id<JavaUtilList>)getPhoneBook {
  return phoneBook_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithJavaUtilList:", "PhoneBookLoaded", NULL, 0x2, NULL, NULL },
    { "getPhoneBook", NULL, "Ljava.util.List;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "phoneBook_", NULL, 0x2, "Ljava.util.List;", NULL, "Ljava/util/List<Lim/actor/core/entity/PhoneBookContact;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _ACBookImportActor_PhoneBookLoaded = { 2, "PhoneBookLoaded", "im.actor.core.modules.internal.contacts", "BookImportActor", 0xa, 2, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_ACBookImportActor_PhoneBookLoaded;
}

@end


#line 251
void ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(ACBookImportActor_PhoneBookLoaded *self, id<JavaUtilList> phoneBook) {
  (void) NSObject_init(self);
  
#line 252
  self->phoneBook_ = phoneBook;
}


#line 251
ACBookImportActor_PhoneBookLoaded *new_ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(id<JavaUtilList> phoneBook) {
  ACBookImportActor_PhoneBookLoaded *self = [ACBookImportActor_PhoneBookLoaded alloc];
  ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(self, phoneBook);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACBookImportActor_PhoneBookLoaded)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/internal/contacts/BookImportActor.java"

@implementation ACBookImportActor_$1


#line 71
- (void)onLoadedWithContacts:(id<JavaUtilList>)contacts {
  [((ARActorRef *) nil_chk([this$0_ self__])) sendWithId:new_ACBookImportActor_PhoneBookLoaded_initWithJavaUtilList_(contacts)];
}

- (instancetype)initWithACBookImportActor:(ACBookImportActor *)outer$ {
  ACBookImportActor_$1_initWithACBookImportActor_(self, outer$);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "onLoadedWithContacts:", "onLoaded", "V", 0x1, NULL, NULL },
    { "initWithACBookImportActor:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lim.actor.core.modules.internal.contacts.BookImportActor;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "ACBookImportActor", "performSync" };
  static const J2ObjcClassInfo _ACBookImportActor_$1 = { 2, "", "im.actor.core.modules.internal.contacts", "BookImportActor", 0x8008, 2, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_ACBookImportActor_$1;
}

@end

void ACBookImportActor_$1_initWithACBookImportActor_(ACBookImportActor_$1 *self, ACBookImportActor *outer$) {
  self->this$0_ = outer$;
  (void) NSObject_init(self);
}

ACBookImportActor_$1 *new_ACBookImportActor_$1_initWithACBookImportActor_(ACBookImportActor *outer$) {
  ACBookImportActor_$1 *self = [ACBookImportActor_$1 alloc];
  ACBookImportActor_$1_initWithACBookImportActor_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACBookImportActor_$1)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/internal/contacts/BookImportActor.java"

@implementation ACBookImportActor_$2


#line 165
- (void)onResult:(ARResponseImportContacts *)response {
  {
    IOSObjectArray *a__ = val$phones_;
    ARApiPhoneToImport * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    ARApiPhoneToImport * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      ARApiPhoneToImport *phoneToImport = *b__++;
      
#line 167
      ACBookImportActor_markImportedWithLong_(this$0_, [((ARApiPhoneToImport *) nil_chk(phoneToImport)) getPhoneNumber]);
      [((JavaUtilHashSet *) nil_chk(this$0_->importingPhones_)) removeWithId:JavaLangLong_valueOfWithLong_([phoneToImport getPhoneNumber])];
    }
  }
  {
    IOSObjectArray *a__ = val$emailToImports_;
    ARApiEmailToImport * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    ARApiEmailToImport * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      ARApiEmailToImport *emailToImport = *b__++;
      
#line 171
      ACBookImportActor_markImportedWithNSString_(this$0_, [((ARApiEmailToImport *) nil_chk(emailToImport)) getEmail]);
      [((JavaUtilHashSet *) nil_chk(this$0_->importingEmails_)) removeWithId:[emailToImport getEmail]];
    }
  }
  if ([((JavaUtilHashSet *) nil_chk(this$0_->importingEmails_)) size] == 0 && [((JavaUtilHashSet *) nil_chk(this$0_->importingPhones_)) size] == 0) {
    ACBookImportActor_markImported(this$0_);
  }
  
#line 179
  if ([((id<JavaUtilList>) nil_chk([((ARResponseImportContacts *) nil_chk(response)) getUsers])) size] == 0) {
    if (this$0_->ENABLE_LOG_) {
      ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"Import success, but no new contacts found");
    }
    return;
  }
  
#line 186
  if (this$0_->ENABLE_LOG_) {
    ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, JreStrcat("$I$", @"Import success with ", [((id<JavaUtilList>) nil_chk([response getUsers])) size], @" new contacts"));
  }
  
#line 190
  JavaUtilArrayList *uids = new_JavaUtilArrayList_init();
  for (ARApiUser * __strong u in nil_chk([response getUsers])) {
    [uids addWithId:JavaLangInteger_valueOfWithInt_([((ARApiUser *) nil_chk(u)) getId])];
  }
  [((ACUpdates *) nil_chk([this$0_ updates])) onUpdateReceivedWithId:new_ARFatSeqUpdate_initWithInt_withByteArray_withInt_withByteArray_withJavaUtilList_withJavaUtilList_(
#line 195
  [response getSeq], [response getState],
#line 196
  ARUpdateContactsAdded_HEADER,
#line 197
  [new_ARUpdateContactsAdded_initWithJavaUtilList_(uids) toByteArray],
#line 198
  [response getUsers], new_JavaUtilArrayList_init())];
}


#line 203
- (void)onError:(ACRpcException *)e {
  
#line 205
  if (this$0_->ENABLE_LOG_) {
    ARLog_dWithNSString_withNSString_(ACBookImportActor_TAG_, @"Import failure");
  }
  [((ACRpcException *) nil_chk(e)) printStackTrace];
}

- (instancetype)initWithACBookImportActor:(ACBookImportActor *)outer$
              withARApiPhoneToImportArray:(IOSObjectArray *)capture$0
              withARApiEmailToImportArray:(IOSObjectArray *)capture$1 {
  ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(self, outer$, capture$0, capture$1);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "onResult:", "onResult", "V", 0x1, NULL, NULL },
    { "onError:", "onError", "V", 0x1, NULL, NULL },
    { "initWithACBookImportActor:withARApiPhoneToImportArray:withARApiEmailToImportArray:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lim.actor.core.modules.internal.contacts.BookImportActor;", NULL, NULL, .constantValue.asLong = 0 },
    { "val$phones_", NULL, 0x1012, "[Lim.actor.core.api.ApiPhoneToImport;", NULL, NULL, .constantValue.asLong = 0 },
    { "val$emailToImports_", NULL, 0x1012, "[Lim.actor.core.api.ApiEmailToImport;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "ACBookImportActor", "performImportWithJavaUtilArrayList:withJavaUtilArrayList:" };
  static const J2ObjcClassInfo _ACBookImportActor_$2 = { 2, "", "im.actor.core.modules.internal.contacts", "BookImportActor", 0x8008, 3, methods, 3, fields, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Lim/actor/core/network/RpcCallback<Lim/actor/core/api/rpc/ResponseImportContacts;>;" };
  return &_ACBookImportActor_$2;
}

@end

void ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(ACBookImportActor_$2 *self, ACBookImportActor *outer$, IOSObjectArray *capture$0, IOSObjectArray *capture$1) {
  self->this$0_ = outer$;
  self->val$phones_ = capture$0;
  self->val$emailToImports_ = capture$1;
  (void) NSObject_init(self);
}

ACBookImportActor_$2 *new_ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(ACBookImportActor *outer$, IOSObjectArray *capture$0, IOSObjectArray *capture$1) {
  ACBookImportActor_$2 *self = [ACBookImportActor_$2 alloc];
  ACBookImportActor_$2_initWithACBookImportActor_withARApiPhoneToImportArray_withARApiEmailToImportArray_(self, outer$, capture$0, capture$1);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACBookImportActor_$2)

#pragma clang diagnostic pop
