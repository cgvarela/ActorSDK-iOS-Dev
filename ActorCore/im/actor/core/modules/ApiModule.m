//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/ApiModule.java
//

#include <j2objc/IOSClass.h>
#include <j2objc/IOSObjectArray.h>
#include <j2objc/J2ObjC_source.h>
#include "im/actor/core/Configuration.h"
#include "im/actor/core/api/parser/RpcParser.h"
#include "im/actor/core/api/parser/UpdatesParser.h"
#include "im/actor/core/modules/AbsModule.h"
#include "im/actor/core/modules/ApiModule.h"
#include "im/actor/core/modules/ModuleContext.h"
#include "im/actor/core/modules/Modules.h"
#include "im/actor/core/modules/Updates.h"
#include "im/actor/core/modules/api/PersistentRequestsActor.h"
#include "im/actor/core/modules/events/AppVisibleChanged.h"
#include "im/actor/core/modules/events/ConnectingStateChanged.h"
#include "im/actor/core/modules/events/NewSessionCreated.h"
#include "im/actor/core/modules/utils/PreferenceApiStorage.h"
#include "im/actor/core/network/ActorApi.h"
#include "im/actor/core/network/ActorApiCallback.h"
#include "im/actor/core/network/Endpoints.h"
#include "im/actor/core/network/parser/ApiParserConfig.h"
#include "im/actor/core/network/parser/ParsingExtension.h"
#include "im/actor/core/network/parser/Request.h"
#include "im/actor/runtime/actors/ActorCreator.h"
#include "im/actor/runtime/actors/ActorRef.h"
#include "im/actor/runtime/actors/ActorSystem.h"
#include "im/actor/runtime/actors/Props.h"
#include "im/actor/runtime/eventbus/Event.h"
#include "im/actor/runtime/eventbus/EventBus.h"
#include "im/actor/runtime/storage/PreferencesStorage.h"

#pragma clang diagnostic push
#pragma GCC diagnostic ignored "-Wdeprecated-declarations"

@interface ACApiModule () {
 @public
  ACActorApi *actorApi_;
  ARActorRef *persistentRequests_;
  ACApiParserConfig *parserConfig_;
}

@end

J2OBJC_FIELD_SETTER(ACApiModule, actorApi_, ACActorApi *)
J2OBJC_FIELD_SETTER(ACApiModule, persistentRequests_, ARActorRef *)
J2OBJC_FIELD_SETTER(ACApiModule, parserConfig_, ACApiParserConfig *)

@interface ACApiModule_ActorApiCallbackImpl : NSObject < ACActorApiCallback > {
 @public
  ACApiModule *this$0_;
}

- (void)onAuthIdInvalidated;

- (void)onNewSessionCreated;

- (void)onUpdateReceived:(id)obj;

- (void)onConnectionsChanged:(jint)count;

- (instancetype)initWithACApiModule:(ACApiModule *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(ACApiModule_ActorApiCallbackImpl)

J2OBJC_FIELD_SETTER(ACApiModule_ActorApiCallbackImpl, this$0_, ACApiModule *)

__attribute__((unused)) static void ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(ACApiModule_ActorApiCallbackImpl *self, ACApiModule *outer$);

__attribute__((unused)) static ACApiModule_ActorApiCallbackImpl *new_ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(ACApiModule *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ACApiModule_ActorApiCallbackImpl)

@interface ACApiModule_$1 : NSObject < ARActorCreator > {
 @public
  ACApiModule *this$0_;
}

- (ImActorCoreModulesApiPersistentRequestsActor *)create;

- (instancetype)initWithACApiModule:(ACApiModule *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(ACApiModule_$1)

J2OBJC_FIELD_SETTER(ACApiModule_$1, this$0_, ACApiModule *)

__attribute__((unused)) static void ACApiModule_$1_initWithACApiModule_(ACApiModule_$1 *self, ACApiModule *outer$);

__attribute__((unused)) static ACApiModule_$1 *new_ACApiModule_$1_initWithACApiModule_(ACApiModule *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(ACApiModule_$1)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/ApiModule.java"


#line 24
@implementation ACApiModule


#line 30
- (instancetype)initWithACModules:(ACModules *)context {
  ACApiModule_initWithACModules_(self, context);
  return self;
}


#line 59
- (ACActorApi *)getActorApi {
  return actorApi_;
}


#line 68
- (ACApiParserConfig *)getParserConfig {
  return parserConfig_;
}


#line 77
- (void)performPersistRequestWithACRequest:(ACRequest *)request {
  [((ARActorRef *) nil_chk(persistentRequests_)) sendWithId:new_ImActorCoreModulesApiPersistentRequestsActor_PerformRequest_initWithACRequest_(request)];
}


#line 89
- (void)performPersistCursorRequestWithNSString:(NSString *)name
                                       withLong:(jlong)key
                                  withACRequest:(ACRequest *)request {
  [((ARActorRef *) nil_chk(persistentRequests_)) sendWithId:new_ImActorCoreModulesApiPersistentRequestsActor_PerformCursorRequest_initWithNSString_withLong_withACRequest_(name, key, request)];
}


#line 94
- (void)onBusEventWithImActorRuntimeEventbusEvent:(ImActorRuntimeEventbusEvent *)event {
  if ([event isKindOfClass:[ImActorCoreModulesEventsAppVisibleChanged class]]) {
    if ([((ImActorCoreModulesEventsAppVisibleChanged *) nil_chk(((ImActorCoreModulesEventsAppVisibleChanged *) check_class_cast(event, [ImActorCoreModulesEventsAppVisibleChanged class])))) isVisible]) {
      [((ACActorApi *) nil_chk(actorApi_)) forceNetworkCheck];
    }
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithACModules:", "ApiModule", NULL, 0x1, NULL, NULL },
    { "getActorApi", NULL, "Lim.actor.core.network.ActorApi;", 0x1, NULL, NULL },
    { "getParserConfig", NULL, "Lim.actor.core.network.parser.ApiParserConfig;", 0x1, NULL, NULL },
    { "performPersistRequestWithACRequest:", "performPersistRequest", "V", 0x1, NULL, NULL },
    { "performPersistCursorRequestWithNSString:withLong:withACRequest:", "performPersistCursorRequest", "V", 0x1, NULL, NULL },
    { "onBusEventWithImActorRuntimeEventbusEvent:", "onBusEvent", "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "actorApi_", NULL, 0x12, "Lim.actor.core.network.ActorApi;", NULL, NULL, .constantValue.asLong = 0 },
    { "persistentRequests_", NULL, 0x12, "Lim.actor.runtime.actors.ActorRef;", NULL, NULL, .constantValue.asLong = 0 },
    { "parserConfig_", NULL, 0x12, "Lim.actor.core.network.parser.ApiParserConfig;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lim.actor.core.modules.ApiModule$ActorApiCallbackImpl;"};
  static const J2ObjcClassInfo _ACApiModule = { 2, "ApiModule", "im.actor.core.modules", NULL, 0x1, 6, methods, 3, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_ACApiModule;
}

@end


#line 30
void ACApiModule_initWithACModules_(ACApiModule *self, ACModules *context) {
  (void) ACAbsModule_initWithACModuleContext_(self, context);
  self->parserConfig_ = new_ACApiParserConfig_init();
  
#line 34
  [self->parserConfig_ addExtensionWithACParsingExtension:new_ACParsingExtension_initWithACBaseParser_withACBaseParser_(new_ARRpcParser_init(), new_ARUpdatesParser_init())];
  
#line 36
  self->actorApi_ = new_ACActorApi_initWithACEndpoints_withACAuthKeyStorage_withACActorApiCallback_withBoolean_withInt_withInt_withInt_withACApiParserConfig_(new_ACEndpoints_initWithARConnectionEndpointArray_([((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getConfiguration])) getEndpoints]), new_ACPreferenceApiStorage_initWithARPreferencesStorage_(
#line 37
  [((id<ACModuleContext>) nil_chk([self context])) getPreferences]), new_ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(self),
#line 39
  [((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getConfiguration])) isEnableNetworkLogging],
#line 40
  [((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getConfiguration])) getMinDelay],
#line 41
  [((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getConfiguration])) getMaxDelay],
#line 42
  [((ACConfiguration *) nil_chk([((id<ACModuleContext>) nil_chk([self context])) getConfiguration])) getMaxFailureCount], self->parserConfig_);
  
#line 44
  [((ImActorRuntimeEventbusEventBus *) nil_chk([((ACModules *) nil_chk(context)) getEvents])) subscribeWithImActorRuntimeEventbusBusSubscriber:self withNSString:ImActorCoreModulesEventsAppVisibleChanged_EVENT_];
  
#line 46
  self->persistentRequests_ = [((ARActorSystem *) nil_chk(ARActorSystem_system())) actorOfWithARProps:ARProps_createWithIOSClass_withARActorCreator_(ImActorCoreModulesApiPersistentRequestsActor_class_(), new_ACApiModule_$1_initWithACApiModule_(self)) withNSString:
#line 51
  @"api/persistence"];
}


#line 30
ACApiModule *new_ACApiModule_initWithACModules_(ACModules *context) {
  ACApiModule *self = [ACApiModule alloc];
  ACApiModule_initWithACModules_(self, context);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACApiModule)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/ApiModule.java"


#line 102
@implementation ACApiModule_ActorApiCallbackImpl


#line 105
- (void)onAuthIdInvalidated {
  [((ACModules *) nil_chk(((ACModules *) check_class_cast([this$0_ context], [ACModules class])))) onLoggedOut];
}


#line 110
- (void)onNewSessionCreated {
  [((ImActorRuntimeEventbusEventBus *) nil_chk([((id<ACModuleContext>) nil_chk([this$0_ context])) getEvents])) postWithImActorRuntimeEventbusEvent:new_ImActorCoreModulesEventsNewSessionCreated_init()];
}


#line 115
- (void)onUpdateReceived:(id)obj {
  [((ACUpdates *) nil_chk([((id<ACModuleContext>) nil_chk([this$0_ context])) getUpdatesModule])) onUpdateReceivedWithId:obj];
}


#line 120
- (void)onConnectionsChanged:(jint)count {
  [((ImActorRuntimeEventbusEventBus *) nil_chk([((id<ACModuleContext>) nil_chk([this$0_ context])) getEvents])) postWithImActorRuntimeEventbusEvent:new_ImActorCoreModulesEventsConnectingStateChanged_initWithBoolean_(count == 0)];
}

- (instancetype)initWithACApiModule:(ACApiModule *)outer$ {
  ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(self, outer$);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "onAuthIdInvalidated", NULL, "V", 0x1, NULL, NULL },
    { "onNewSessionCreated", NULL, "V", 0x1, NULL, NULL },
    { "onUpdateReceived:", "onUpdateReceived", "V", 0x1, NULL, NULL },
    { "onConnectionsChanged:", "onConnectionsChanged", "V", 0x1, NULL, NULL },
    { "initWithACApiModule:", "init", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lim.actor.core.modules.ApiModule;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _ACApiModule_ActorApiCallbackImpl = { 2, "ActorApiCallbackImpl", "im.actor.core.modules", "ApiModule", 0x2, 5, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_ACApiModule_ActorApiCallbackImpl;
}

@end

void ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(ACApiModule_ActorApiCallbackImpl *self, ACApiModule *outer$) {
  self->this$0_ = outer$;
  (void) NSObject_init(self);
}

ACApiModule_ActorApiCallbackImpl *new_ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(ACApiModule *outer$) {
  ACApiModule_ActorApiCallbackImpl *self = [ACApiModule_ActorApiCallbackImpl alloc];
  ACApiModule_ActorApiCallbackImpl_initWithACApiModule_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACApiModule_ActorApiCallbackImpl)

#line 0 "/Users/ex3ndr/Develop/actor-proprietary/actor-sdk/sdk-core/core/core-shared/src/main/java//im/actor/core/modules/ApiModule.java"

@implementation ACApiModule_$1


#line 48
- (ImActorCoreModulesApiPersistentRequestsActor *)create {
  return new_ImActorCoreModulesApiPersistentRequestsActor_initWithACModuleContext_([this$0_ context]);
}

- (instancetype)initWithACApiModule:(ACApiModule *)outer$ {
  ACApiModule_$1_initWithACApiModule_(self, outer$);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "create", NULL, "Lim.actor.core.modules.api.PersistentRequestsActor;", 0x1, NULL, NULL },
    { "initWithACApiModule:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lim.actor.core.modules.ApiModule;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "ACApiModule", "initWithACModules:" };
  static const J2ObjcClassInfo _ACApiModule_$1 = { 2, "", "im.actor.core.modules", "ApiModule", 0x8008, 2, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Lim/actor/runtime/actors/ActorCreator<Lim/actor/core/modules/api/PersistentRequestsActor;>;" };
  return &_ACApiModule_$1;
}

@end

void ACApiModule_$1_initWithACApiModule_(ACApiModule_$1 *self, ACApiModule *outer$) {
  self->this$0_ = outer$;
  (void) NSObject_init(self);
}

ACApiModule_$1 *new_ACApiModule_$1_initWithACApiModule_(ACApiModule *outer$) {
  ACApiModule_$1 *self = [ACApiModule_$1 alloc];
  ACApiModule_$1_initWithACApiModule_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ACApiModule_$1)

#pragma clang diagnostic pop
